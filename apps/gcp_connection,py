import pandas as pd
from st_files_connection import FilesConnection
# Create connection object and retrieve file contents.

def read_TIN_data(conn):
    def reformat_TIN(x):
        x = str(x)
        x_split = x.split(" ")
        if len(x_split) == 1:
            return x
        else:
            return x_split[1]
    # conn = st.connection('gcs', type=FilesConnection)
    df = conn.read("ncb_xml_parsing_tool/data_TIN.csv", input_format="csv", ttl=600)
    df["TIN"] = df["TIN"].apply(lambda x: reformat_TIN(x))
    return df


def read_XML_data(conn):
    # conn = st.connection('gcs', type=FilesConnection)
    df = conn.read("ncb_xml_parsing_tool/data_XML.csv", input_format="csv", ttl=600)
    return df
